!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Boid=t()}}(function(){return function t(e,n,i){function r(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return r(n?n:t)},d,d.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){"use strict";function i(t){t=o(t);var e=s.get(),n=s.get(),r=s.get(),u=t.bounds,a=t.edgeBehavior,c=t.mass,d=t.maxSpeed,h=d*d,f=t.maxForce,l=t.arriveThreshold,p=l*l,y=t.wanderDistance,g=t.wanderRadius,x=t.wanderAngle,v=t.wanderRange,m=t.avoidDistance,b=t.avoidBuffer,w=0,B=t.pathThreshold,D=B*B,q=t.maxDistance,E=q*q,z=t.minDistance,S=z*z,P=function(t,e,n,i){return u.width=t,u.height=e,u.x=n||0,u.y=i||0,W},M=function(){return r.truncate(f),r.divideBy(c),n.add(r),r.reset(),n.truncate(d),e.add(n),a===i.EDGE_BOUNCE?O():a===i.EDGE_WRAP&&j(),W},O=function(){e.x>u.width?(e.x=u.width,n.x*=-1):e.x<u.x&&(e.x=u.x,n.x*=-1),e.y>u.height?(e.y=u.height,n.y*=-1):e.y<u.y&&(e.y=u.y,n.y*=-1)},j=function(){e.x>u.width?e.x=u.x:e.x<u.x&&(e.x=u.width),e.y>u.height?e.y=u.y:e.y<u.y&&(e.y=u.height)},N=function(t){var i=t.clone().subtract(e);i.normalize(),i.scaleBy(d);var o=i.subtract(n);return r.add(o),o.dispose(),W},R=function(t){var i=t.clone().subtract(e);i.normalize(),i.scaleBy(d);var o=i.subtract(n);return r.subtract(o),o.dispose(),W},T=function(t){var i=t.clone().subtract(e);i.normalize();var o=e.distanceSq(t);if(o>p)i.scaleBy(d);else{var s=d*o/p;i.scaleBy(s)}var u=i.subtract(n);return r.add(u),u.dispose(),W},_=function(t){var n=e.distanceSq(t.position)/h,i=t.velocity.clone().scaleBy(n),r=t.position.clone().add(i);return N(r),i.dispose(),r.dispose(),W},G=function(t){var n=e.distanceSq(t.position)/h,i=t.velocity.clone().scaleBy(n),r=t.position.clone().add(i);return R(r),i.dispose(),r.dispose(),W},A=function(){var t=n.clone().normalize().scaleBy(y),e=s.get();e.length=g,e.angle=x,x+=Math.random()*v-.5*v;var i=t.add(e);return r.add(i),e.dispose(),i.dispose(),W},F=function(t){for(var i=0;i<t.length;i++){var o=t[i],s=n.clone().normalize(),u=o.position.clone().subtract(e),a=u.dotProduct(s);if(a>0){var c=s.clone().scaleBy(m),h=s.clone().scaleBy(a),f=h.subtract(u),l=f.length;if(l<(o.radius||0)+b&&h.length<c.length){var p=s.clone().scaleBy(d);p.angle+=u.sign(n)*Math.PI/2,p.scaleBy(1-h.length/c.length),r.add(p),n.scaleBy(h.length/c.length),p.dispose()}c.dispose(),h.dispose(),f.dispose()}s.dispose(),u.dispose()}return W},U=function(t,n){n=!!n;var i=t[w];return i?(e.distanceSq(i)<D&&(w>=t.length-1?n&&(w=0):w++),w>=t.length-1&&!n?T(i):N(i),W):(w=0,W)},k=function(t){for(var e=n.clone(),i=s.get(),o=0,u=0;u<t.length;u++){var a=t[u];a!==W&&C(a)&&(e.add(a.velocity),i.add(a.position),I(a)&&R(a.position),o++)}return o>0&&(e.divideBy(o),i.divideBy(o),N(i),r.add(e.subtract(n))),e.dispose(),i.dispose(),W},C=function(t){if(e.distanceSq(t.position)>E)return!1;var i=n.clone().normalize(),r=t.position.clone().subtract(e),o=r.dotProduct(i);return i.dispose(),r.dispose(),!(0>o)},I=function(t){return e.distanceSq(t.position)<S},W={setBounds:P,update:M,pursue:_,evade:G,wander:A,avoid:F,followPath:U,flock:k,arrive:T,seek:N,flee:R,position:e,velocity:n,userData:{}};return Object.defineProperties(W,{edgeBehavior:{get:function(){return a},set:function(t){a=t}},mass:{get:function(){return c},set:function(t){c=t}},maxSpeed:{get:function(){return d},set:function(t){d=t,h=t*t}},maxForce:{get:function(){return f},set:function(t){f=t}},arriveThreshold:{get:function(){return l},set:function(t){l=t,p=t*t}},wanderDistance:{get:function(){return y},set:function(t){y=t}},wanderRadius:{get:function(){return g},set:function(t){g=t}},wanderRange:{get:function(){return v},set:function(t){v=t}},avoidDistance:{get:function(){return m},set:function(t){m=t}},avoidBuffer:{get:function(){return b},set:function(t){b=t}},pathIndex:{get:function(){return w},set:function(t){w=t}},pathThreshold:{get:function(){return B},set:function(t){B=t,D=t*t}},maxDistance:{get:function(){return q},set:function(t){q=t,E=t*t}},minDistance:{get:function(){return z},set:function(t){z=t,S=t*t}}}),Object.freeze(W)}function r(t,e){Object.keys(e).forEach(function(n){"undefined"==typeof t[n]&&(t[n]=e[n])})}function o(t){return t=t||{},t.bounds=t.bounds||{},r(t,u),r(t.bounds,u.bounds),t}var s=t("./vec2.js"),u={bounds:{x:0,y:0,width:640,height:480},edgeBehavior:"bounce",mass:1,maxSpeed:10,maxForce:1,arriveThreshold:50,wanderDistance:10,wanderRadius:5,wanderAngle:0,wanderRange:1,avoidDistance:300,avoidBuffer:20,pathThreshold:20,maxDistance:300,minDistance:60};i.EDGE_NONE="none",i.EDGE_BOUNCE="bounce",i.EDGE_WRAP="wrap",i.Vec2=s,i.vec2=function(t,e){return s.get(t,e)},i.obstacle=function(t,e,n){return{radius:t,position:s.get(e,n)}},"object"==typeof e&&e.exports&&(e.exports=i)},{"./vec2.js":2}],2:[function(t,e,n){"use strict";function i(t,e){this.x=t||0,this.y=e||0}i.prototype={add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},subtract:function(t){return this.x=this.x-t.x,this.y=this.y-t.y,this},normalize:function(){var t=this.length;return 0===t?(this.x=1,this):1===t?this:(this.x/=t,this.y/=t,this)},isNormalized:function(){return 1===this.length},truncate:function(t){return this.length>t&&(this.length=t),this},scaleBy:function(t){return this.x*=t,this.y*=t,this},divideBy:function(t){return this.x/=t,this.y/=t,this},equals:function(t){return this.x===t.x&&this.y===t.y},negate:function(){return this.x=-this.x,this.y=-this.y,this},dotProduct:function(t){return this.x*t.x+this.y*t.y},crossProduct:function(t){return this.x*t.y-this.y*t.x},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},distance:function(t){return Math.sqrt(this.distanceSq(t))},clone:function(){return i.get(this.x,this.y)},reset:function(){return this.x=0,this.y=0,this},perpendicular:function(){return i.get(-this.y,this.x)},sign:function(t){var e=this.perpendicular(),n=e.dotProduct(t)<0?-1:1;return e.dispose(),n},set:function(t,e){return this.x=t||0,this.y=e||0,this},dispose:function(){i.pool.push(this.reset())}},Object.defineProperties(i.prototype,{lengthSquared:{get:function(){return this.x*this.x+this.y*this.y}},length:{get:function(){return Math.sqrt(this.lengthSquared)},set:function(t){var e=this.angle;this.x=Math.cos(e)*t,this.y=Math.sin(e)*t}},angle:{get:function(){return Math.atan2(this.y,this.x)},set:function(t){var e=this.length;this.x=Math.cos(t)*e,this.y=Math.sin(t)*e}}}),i.pool=[],i.get=function(t,e){var n=i.pool.length>0?i.pool.pop():new i;return n.set(t,e),n},i.fill=function(t){for(;i.pool.length<t;)i.pool.push(new i)},i.angleBetween=function(t,e){return t.isNormalized()||(t=t.clone().normalize()),e.isNormalized()||(e=e.clone().normalize()),Math.acos(t.dotProduct(e))},"object"==typeof e&&e.exports&&(e.exports=i)},{}]},{},[1])(1)});